
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>FixNow Mechanics — Mobile Mechanic</title>
  <meta name="description" content="Mobile mechanic. Same-day diagnostics, servicing & repairs at your doorstep.">
  <link rel="canonical" href="https://fixnowmechanics.co.uk/">
  <meta property="og:title" content="FixNow Mechanics — Mobile Mechanic">
  <meta property="og:description" content="Mobile mechanic. Same-day diagnostics, servicing & repairs at your doorstep.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://fixnowmechanics.co.uk/">
  <meta property="og:image" content="https://placehold.co/1200x630/png?text=FixNow+Mechanics">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="icon" href="/assets/favicon.svg">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --bg:#0b0f17; --muted:rgba(255,255,255,.65); --card:rgba(255,255,255,.04); --border:rgba(255,255,255,.08); --brand:#22c55e; }
    body { background:var(--bg); color:#e7eaf0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter; }
    .btn { display:inline-flex; align-items:center; gap:.6rem; padding:.9rem 1.1rem; border-radius:9999px; font-weight:700; }
    .btn-primary { background:var(--brand); color:#04110a; }
    .btn-ghost { border:1px solid var(--border); }
    .card { background:var(--card); border:1px solid var(--border); border-radius:1rem; }
    .grid-auto { display:grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap:1rem; }
    .hero { background: radial-gradient(1200px 500px at 50% -10%, rgba(59,130,246,.25), transparent 60%), url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="800"><defs><pattern id="p" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M0 40h40M0 0h40M0 0v40M40 0v40" stroke="rgba(255,255,255,0.03)" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(%23p)"/></svg>') center/cover no-repeat; }
    .chip { display:inline-block; padding:.35rem .7rem; border-radius:9999px; border:1px solid var(--border); color:var(--muted); font-size:.9rem; }

    /* POPUP AI ASSISTANT */
    .overlay { position:fixed; inset:0; background:rgba(0,0,0,.65); display:none; z-index:50; opacity:0; transition:opacity .2s ease; }
    .overlay.open { display:block; opacity:1; }
    .ai-panel { position:fixed; right:50%; top:50%; transform:translate(50%, 60%) scale(.96); opacity:0; width:760px; max-width:95vw; max-height:85vh; display:none; z-index:60;
      background:#0f1420; border:1px solid var(--border); border-radius:1rem; overflow:hidden; transition: all .25s ease; }
    .ai-panel.open { display:block; transform:translate(50%, -50%) scale(1); opacity:1; }
    .ai-header { display:flex; align-items:center; justify-content:space-between; padding:1rem; background:#0e1220; border-bottom:1px solid var(--border) }
    .ai-body { display:grid; grid-template-columns: 1fr 320px; gap:1rem; padding:1rem; max-height:62vh; overflow:auto; }
    .ai-col { background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)); border:1px solid var(--border); border-radius:.75rem; padding:1rem; }
    .ai-chat { max-height:54vh; overflow:auto; }
    .msg { padding:.6rem .8rem; border-radius:.8rem; margin:.35rem 0; max-width:95% }
    .msg-user { background:#1b2436; margin-left:auto }
    .msg-bot { background:#111827; border:1px solid var(--border) }
    .ai-input { display:flex; gap:.5rem; padding:1rem; border-top:1px solid var(--border); background:#0e1220 }
    .ai-input input, .ai-input textarea { flex:1; background:#0b0f17; border:1px solid var(--border); border-radius:.7rem; padding:.65rem .8rem; color:#e7eaf0; min-height:44px; }
    .tip { color:var(--muted); font-size:.9rem; }
    .fab { position:fixed; right:1rem; bottom:1rem; z-index:61; box-shadow:0 10px 30px rgba(0,0,0,.4); }
    .preview { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Courier New", monospace; font-size:.95rem; white-space:pre-wrap; }
    @media (max-width:860px) { .ai-body { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <header class="sticky top-0 z-50 bg-black/40 backdrop-blur border-b border-white/10">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="/" class="flex items-center gap-3">
        <img src="/assets/logo.svg" alt="FixNow Mechanics" class="w-10 h-10">
        <strong>FixNow Mechanics</strong>
      </a>
      <div class="flex items-center gap-3">
        <a href="https://wa.me/447444255968" class="btn btn-primary">WhatsApp</a>
        <button id="openAI" class="btn btn-ghost" type="button">AI to Book</button>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="max-w-5xl mx-auto px-4">
      <div class="min-h-[64vh] flex flex-col justify-center">
        <div class="max-w-2xl bg-black/45 p-6 md:p-8 rounded-2xl">
          <p class="uppercase tracking-wider text-xs text-white/70">Mobile • Same-Day • 7am–10pm</p>
          <h1 class="text-4xl md:text-6xl font-extrabold leading-tight mt-2">Car trouble? FixNow — We Come To You.</h1>
          <p class="text-lg md:text-xl text-white/85 mt-3">Mobile mechanic. Same-day diagnostics, servicing & repairs at your doorstep.</p>
          <div class="mt-4 space-x-2">
            <span class="chip">OBD Diagnostics</span>
            <span class="chip">Servicing</span>
            <span class="chip">Brakes</span>
            <span class="chip">Battery</span>
            <span class="chip">Breakdown Assist</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-12">
    <div class="max-w-5xl mx-auto px-4 grid-auto">
      <div class="card p-5"><h3 class="font-bold text-lg">Diagnostics</h3><p class="opacity-85">Full scan • fault report • clear codes.</p><p class="mt-2">From <b>£49</b></p><a class="btn btn-primary mt-3" href="https://wa.me/447444255968">WhatsApp</a></div>
      <div class="card p-5"><h3 class="font-bold text-lg">Servicing</h3><p class="opacity-85">Interim & full service (OEM-spec parts).</p><p class="mt-2">From <b>£129</b></p><a class="btn btn-primary mt-3" href="https://wa.me/447444255968">WhatsApp</a></div>
      <div class="card p-5"><h3 class="font-bold text-lg">Brakes</h3><p class="opacity-85">Pads/discs — front or rear.</p><p class="mt-2">From <b>£99</b></p><a class="btn btn-primary mt-3" href="https://wa.me/447444255968">WhatsApp</a></div>
      <div class="card p-5"><h3 class="font-bold text-lg">Battery</h3><p class="opacity-85">Test • supply • fit (coding if required).</p><p class="mt-2">From <b>£79</b></p><a class="btn btn-primary mt-3" href="https://wa.me/447444255968">WhatsApp</a></div>
    </div>
  </section>

  <footer class="border-t border-white/10">
    <div class="max-w-5xl mx-auto px-4 py-8 text-sm flex items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <img src="/assets/logo.svg" class="w-7 h-7" alt="FixNow Mechanics">
        <span>© 2025 FixNow Mechanics</span>
      </div>
      <div class="opacity-80">Open 7:00–22:00 • Greater London & Hertfordshire</div>
    </div>
  </footer>

  <!-- Overlay + AI Panel -->
  <div class="overlay" id="aiOverlay"></div>
  <div class="ai-panel" id="aiPanel" role="dialog" aria-modal="true" aria-label="FixNow AI Assistant">
    <div class="ai-header">
      <strong>FixNow AI — craft your WhatsApp message</strong>
      <button id="closeAI" title="Close">✕</button>
    </div>
    <div class="ai-body">
      <div class="ai-col">
        <div id="aiChat" class="ai-chat">
          <div class="msg msg-bot">Tell me what's wrong and where you are (e.g., “Fiesta won't start in HA3, reg AB12 CDE, need today after 5pm”).</div>
        </div>
        <div class="ai-input">
          <input id="aiInput" placeholder="Type here and press Enter…" autocomplete="off">
          <button id="aiSend" class="btn btn-primary" type="button">Ask AI</button>
        </div>
        <p class="tip">The assistant turns your message into a clear booking text for WhatsApp.</p>
      </div>
      <div class="ai-col">
        <h3 class="font-bold mb-2">Preview</h3>
        <div id="aiPreview" class="preview card p-3">Your message will appear here…</div>
        <a id="waBtn" class="btn btn-primary mt-3 inline-flex" href="https://wa.me/447444255968" target="_blank" rel="noopener">Open WhatsApp with this message</a>
        <p id="aiStatus" class="tip mt-3"></p>
      </div>
    </div>
  </div>

  <!-- Floating Button -->
  <button class="fab btn btn-primary" id="aiLaunch">AI to Book</button>

  <script>
    const PHONE = "447444255968";

    function openAI() {
      document.getElementById('aiPanel').classList.add('open');
      document.getElementById('aiOverlay').classList.add('open');
      setTimeout(() => document.getElementById('aiInput').focus(), 60);
    }
    function closeAI() {
      document.getElementById('aiPanel').classList.remove('open');
      document.getElementById('aiOverlay').classList.remove('open');
    }

    document.getElementById('aiLaunch').addEventListener('click', openAI);
    document.getElementById('openAI').addEventListener('click', openAI);
    document.getElementById('closeAI').addEventListener('click', closeAI);
    document.getElementById('aiOverlay').addEventListener('click', closeAI);

    const chat = document.getElementById('aiChat');
    const input = document.getElementById('aiInput');
    const send = document.getElementById('aiSend');
    const preview = document.getElementById('aiPreview');
    const waBtn = document.getElementById('waBtn');
    const statusEl = document.getElementById('aiStatus');

    function addMsg(text, who='bot') {
      const div = document.createElement('div');
      div.className = 'msg ' + (who==='user' ? 'msg-user' : 'msg-bot');
      div.textContent = text;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    async function composeWithAI(userText) {
      try {
        statusEl.textContent = "Thinking…";
        const rsp = await fetch('/api/compose', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ input: userText })
        });
        if (!rsp.ok) throw new Error('API error ' + rsp.status);
        const data = await rsp.json();
        statusEl.textContent = "";
        return data.message || userText;
      } catch (e) {
        // graceful fallback: local heuristic
        statusEl.textContent = "AI offline — using a quick fallback.";
        const ukPlate = /\b([A-Z]{2}\d{2}\s?[A-Z]{3}|[A-Z]{1,3}\d{1,4}\s?[A-Z]{1,3})\b/i;
        const postcode = /\b([A-Z]{1,2}\d{1,2}[A-Z]?\s?\d[A-Z]{2})\b/i;
        const whenRe = /(today|tomorrow|weekend|sat|sun|monday|tuesday|wednesday|thursday|friday|\b\d{1,2}(?::\d{2})?\s?(am|pm)?)/i;
        const plate = (userText.match(ukPlate)||[])[0] || '[reg?]';
        const pc = (userText.match(postcode)||[])[0] || '[postcode?]';
        const when = (userText.match(whenRe)||[])[0] || '[when?]';
        return `Booking — Mobile Mechanic\nReg: ${plate}\nPostcode: ${pc}\nWhen: ${when}\nNotes: ${userText.slice(0,200)}`;
      }
    }

    async function handleSend() {
      const t = input.value.trim();
      if (!t) return;
      addMsg(t, 'user');
      input.value = '';
      const msg = await composeWithAI(t);
      const previewText = msg;
      preview.textContent = previewText;
      waBtn.href = 'https://wa.me/' + PHONE + '?text=' + encodeURIComponent(previewText);
      addMsg('Here’s a WhatsApp-ready message. Tap the button on the right to send.', 'bot');
    }

    send.addEventListener('click', handleSend);
    input.addEventListener('keydown', (e) => { if (e.key === 'Enter') handleSend(); });
  </script>
</body>
</html>
